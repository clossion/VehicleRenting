
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Buyer</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
        <style>
        body {
            background: linear-gradient(to right, #FFFFFF, #E0E0E0);
            font-family: 'Helvetica Neue', sans-serif;
        }
        .navbar {
            background-color: #333;
        }
        .navbar-brand {
            color: #fff;
        }
        .navbar-nav .nav-link {
            color: #fff;
        }
        .card {
            width: 300px; /* 设置卡片的固定宽度 */
            height: 400px; /* 设置卡片的固定高度 */
            margin-bottom: 20px; /* 调整卡片之间的间距 */
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease-in-out;
            /* 添加最大高度并设置溢出内容为隐藏 */
            max-height: 600px;
            overflow: hidden;
        }
        .card:hover {
            transform: scale(1.05);
        }
        .card-img-top {
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            /* 设置图片高度并确保图片正确裁剪和填充 */
            height: 200px;
            object-fit: cover;
        }
        .card-body {
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">汽车租赁平台</a>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('buyer_orders') }}">订单管理</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('personal') }}">修改个人信息</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="{{ url_for('logout') }}">登出</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="container mt-4">
        <h1>欢迎来到汽车租赁平台</h1>
        <p>你好, {{ current_user.username }}!</p>
        <p>邮箱: {{ current_user.email }}</p>
        <p>电话: {{ current_user.phone }}</p>
        <p>地址: {{ current_user.address_country }}, {{ current_user.address_state }}, {{ current_user.address_city }}, {{ current_user.address_detail }}</p>
        <div class="btn-group" role="group" aria-label="Alphabetical Search">
            <button type="button" class="btn btn-secondary" onclick="clickLetter('A')">A</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('B')">B</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('C')">C</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('D')">D</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('E')">E</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('F')">F</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('G')">G</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('H')">H</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('I')">I</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('J')">J</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('K')">K</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('L')">L</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('M')">M</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('N')">N</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('O')">O</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('P')">P</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('Q')">Q</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('R')">R</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('S')">S</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('T')">T</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('U')">U</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('V')">V</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('W')">W</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('X')">X</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('Y')">Y</button>
            <button type="button" class="btn btn-secondary" onclick="clickLetter('Z')">Z</button>
        </div>
        <select id="brand-select" class="form-control" onchange="filterByBrand(this.value)" style="display: none;">
        </select>
        <select id="model-select" class="form-control" onchange="filterByModel(this.value)" style="display: none;">
        </select>
        <div class="row">
            <h2 class="col-12">我要租车！</h2>
            <div class="row" id="vehicle-list"></div>
        </div>
    </div>
    <script>
            function createVehicleCard(vehicle) {
                return `
                    <div class="col-sm-4">
                        <div class="card">
                            <a href="/rent_vehicle/${vehicle.id}">
                                <img class="card-img-top" src="${vehicle.photo_url}" alt="Vehicle Photo">
                                <div class="card-body">
                                    <h5 class="card-title">${vehicle.brand} ${vehicle.model}</h5>
                                    </p><p class="card-text">Price per day: ${vehicle.price_per_day}</p>
                                    <a href="/rent_vehicle/${vehicle.id}" class="btn btn-primary">租给我！</a>
                                </div>
                            </a>
                        </div>
                    </div>
                `;
            }

            function filterByLetter(letter) {
                if (letter === "...") {
                    fetch(`/vehicles/filter`)
                        .then(response => response.json())
                        .then(vehicles => {
                            displayVehicles(vehicles);
                        });
                } else {
                    fetch(`/brands/${letter}`)
                        .then(response => response.json())
                        .then(brands => {
                            const brandSelect = document.getElementById('brand-select');
                            brandSelect.style.display = 'block';
                            brandSelect.innerHTML = '<option>...</option>';

                            for (const brand of brands) {
                                const option = document.createElement('option');
                                option.value = brand;
                                option.textContent = brand;
                                brandSelect.appendChild(option);
                            }

                            fetch(`/vehicles/filter?letter=${letter}`)
                                .then(response => response.json())
                                .then(vehicles => {
                                    displayVehicles(vehicles);
                                });
                        });
                }
            }


            let selectedLetter = null;

            function clickLetter(letter) {
                selectedLetter = letter;
                filterByLetter(letter);
            }

            function filterByBrand(brand) {
                if (brand === "...") {
                    fetch(`/vehicles/filter`)
                        .then(response => response.json())
                        .then(vehicles => {
                            displayVehicles(vehicles);
                        });
                } else {
                    fetch(`/models/${brand}`)
                        .then(response => response.json())
                        .then(models => {
                            const modelSelect = document.getElementById('model-select');
                            modelSelect.style.display = 'block';
                            modelSelect.innerHTML = '<option>...</option>';

                            for (const model of models) {
                                const option = document.createElement('option');
                                option.value = model;
                                option.textContent = model;
                                modelSelect.appendChild(option);
                            }

                            fetch(`/vehicles/filter?letter=${selectedLetter}&brand=${brand}`)
                                .then(response => response.json())
                                .then(vehicles => {
                                    displayVehicles(vehicles);
                                });
                        });
                }
            }


            function filterByModel(model) {
                const brand = document.getElementById('brand-select').value;

                if (model === "...") {
                    fetch(`/vehicles/filter?brand=${brand}`)
                        .then(response => response.json())
                        .then(vehicles => {
                            displayVehicles(vehicles);
                        });
                } else {
                    fetch(`/vehicles/filter?brand=${brand}&model=${model}`)
                        .then(response => response.json())
                        .then(vehicles => {
                            displayVehicles(vehicles);
                        });
                }
            }

            function displayVehicles(vehicles) {
                const vehicleList = document.getElementById('vehicle-list');
                vehicleList.innerHTML = '';

                for (const vehicle of vehicles) {
                    const vehicleItem = createVehicleCard(vehicle);
                    vehicleList.innerHTML += vehicleItem;
                }
            }

            window.onload = function() {
                filterByLetter("...");
            };
    </script>
</body>
</html>